<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

<h:head>
    <title>Car Types</title>

    <!-- Bootstrap CSS -->
    <link rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />

    <!-- Custom CSS for admin page -->
    <h:outputStylesheet name="css/admin-page.css" />

    <script>
        /**
         * Toggle the visibility of the hidden detail row
         * Each car type has an expandable section with more details
         */
        function toggleDetails(id) {
            const row = document.getElementById(id);
            row.style.display = row.style.display === "table-row" ? "none" : "table-row";
        }
    </script>
</h:head>

<h:body style="background:#f7f7f7;">

    <div class="container mt-5">

        <h2 class="mb-4 text-center d-flex justify-content-between align-items-center">
            <span>Car Type List</span>

            <!-- Add New Car Type Button -->
            <h:form styleClass="m-0">
                <h:commandButton value="Add New Car Type"
                                 action="/pages/admin/car_type_form.xhtml?faces-redirect=true"
                                 styleClass="btn btn-success"/>
            </h:form>
        </h2>

        <div class="card shadow">
            <div class="card-body">
                <table class="table table-striped table-hover align-middle">
                    <thead class="table-dark">
                    <tr>
                        <th>Brand / Model</th>
                        <th>Category</th>
                        <th>Engine</th>
                        <th>Power</th>
                        <th>Seats</th>
                        <th class="edit-col">Actions</th>
                    </tr>
                    </thead>

                    <tbody>
                    <ui:repeat value="#{carTypeBean.carTypes}" var="t" varStatus="vs">
                        <tr onclick="toggleDetails('detail#{vs.index}')">
                            <td><strong>#{t.brand}</strong> #{t.model}</td>
                            <td>#{t.category}</td>
                            <td>#{t.engine}</td>
                            <td>#{t.power} hp</td>
                            <td>#{t.seats}</td>
                            <td class="edit-col">
                                <h:form>
                                    <h:commandLink value="Edit"
                                                   styleClass="btn btn-primary btn-sm"
                                                   action="#{carTypeBean.goToEdit(t.id)}" />
                                    <!-- Delete Button -->
                                    <h:commandButton value="Delete"
                                                     styleClass="btn btn-danger btn-sm"
                                                     action="#{carTypeBean.deleteCarType(t.id)}"
                                                     onclick="return confirm('Are you sure you want to delete this car type?');"
                                                     immediate="true"/>
                                </h:form>
                            </td>
                        </tr>

                        <tr id="detail#{vs.index}" class="details-row" style="display:none;">
                            <td colspan="6" class="details-cell">
                                <p><strong>Description:</strong> #{t.description}</p>
                                <p><strong>Drive Type:</strong> #{t.driveType}</p>
                                <p><strong>Max Speed:</strong> #{t.maxSpeed} km/h</p>
                                <p><strong>Weight:</strong> #{t.weight} kg</p>
                                <p><strong>Acceleration:</strong> #{t.acceleration} sec 0-100</p>
                                <strong>Features:</strong>
                                <ui:repeat value="#{t.features}" var="f">
                                    <span class="badge bg-secondary me-1">#{f}</span>
                                </ui:repeat>
                            </td>
                        </tr>
                    </ui:repeat>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

</h:body>
</html>